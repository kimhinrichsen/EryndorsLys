/* Styles med archetype-specifik lore-popup baggrund (v7.1) */
/* (Resten svarer til tidligere version med små justeringer for baggrund) */

body {
  background: url('./tavern-bg.jpg') center center/cover no-repeat fixed;
  color: #ffebc0;
  font-family: 'Cinzel', 'Segoe UI', Arial, sans-serif;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  width: 100vw;
  box-sizing: border-box;
  display: flex;
  align-items: center;
  justify-content: center;
}

.lock-scroll { overflow: hidden; }

/* Header / XP bar / Story / Profile (uændret fra tidligere svar - forkortet hvor muligt) */
.kro-header { font-family: 'Cinzel', serif; color:#ffeec0; font-size:2.3em; text-align:center; margin-bottom:24px; text-shadow:0 0 22px #b4874f55; }
.kro-xp-bar-container { width:100%; max-width:780px; display:flex; align-items:center; gap:15px; margin-bottom:18px; justify-content:center; }
.kro-xp-emblem { font-size:2em; }
.kro-xp-bar { flex:1; height:24px; background:linear-gradient(90deg,#ffeec0 0%,#b4874f 100%); border-radius:12px; box-shadow:0 0 9px #fffbe833; overflow:hidden; min-width:120px; max-width:400px; }
.kro-xp-bar-fill { background:linear-gradient(90deg,#fcc65d,#f7c873 80%); height:100%; border-radius:12px; transition:width .32s; }
.kro-xp-bar-label { font-size:1.09em; font-family:'Cinzel',serif; color:#ffeec0; text-shadow:0 0 7px #b4874f55; margin-left:10px; }

.kro-storybox { background:rgba(50,35,19,.97); border-radius:18px; box-shadow:0 6px 30px #432a0f99; padding:22px 24px; margin-bottom:18px; text-align:center; }
.kro-storytitle { font-family:'Cinzel',serif; font-size:1.27em; margin-bottom:7px; }
.kro-storybody { font-size:1.1em; }

.kro-profilbox { background:rgba(40,30,16,0.89); border-radius:16px; box-shadow:0 8px 30px #432a0f99; padding:14px 28px; margin:18px 0; font-family:'Cinzel',serif; font-size:1.25rem; display:flex; gap:12px; align-items:center; justify-content:center; }

.kro-mentors { width:100%; max-width:1000px; display:flex; flex-direction:column; align-items:center; margin-bottom:16px; }
.kro-mentors-row { display:flex; flex-wrap:wrap; gap:20px; justify-content:center; width:100%; }
.kro-mentorbox { padding:12px 10px; border-radius:14px; font-weight:600; display:flex; flex-direction:column; align-items:center; box-shadow:0 0 14px #0007; border:2px solid #fffbe8; background:#1a1a1a; cursor:pointer; min-width:120px; max-width:150px; flex:1 1 140px; transition:transform .18s; }
.kro-mentorbox:hover { transform:scale(1.04); box-shadow:0 0 18px #fffbe855; }
.kro-mentor-img { width:70px; height:70px; object-fit:cover; border-radius:50%; margin-bottom:7px; border:2px solid #fcc65d; box-shadow:0 0 10px #b4874f99; }
.kro-mentor-main { font-size:1em; margin-bottom:6px; text-align:center; color:#ffeec0; font-family:'Cinzel',serif; }
.kro-mentor-progressbar { width:100%; display:flex; flex-direction:column; align-items:center; gap:4px; }
.kro-mentor-bar { width:90%; height:10px; background:linear-gradient(90deg,#fffbe8 0%,#b4874f 100%); border-radius:7px; box-shadow:0 0 5px #fffbe833; overflow:hidden; margin-bottom:2px; }
.kro-mentor-bar-fill { background:linear-gradient(90deg,#fcc65d,#f7c873 80%); height:100%; border-radius:7px; transition:width .32s; }
.kro-mentor-bar-label { font-size:.82em; font-family:'Cinzel',serif; color:#ffeec0; }
@media (min-width:860px){
  .kro-mentors-row { flex-wrap:nowrap; gap:12px; }
  .kro-mentorbox { flex:0 1 165px; min-width:165px; max-width:170px; padding:10px 8px; }
  .kro-mentor-img { width:60px; height:60px; margin-bottom:6px; }
  .kro-mentor-main { font-size:.85rem; margin-bottom:4px; }
  .kro-mentor-bar { height:6px; }
  .kro-mentor-emblem { font-size:.85rem; }
}

/* Quests (forkortet) */
.kro-quests { display:flex; flex-wrap:wrap; gap:24px; justify-content:center; width:100%; max-width:1000px; }
.kro-questroll { background:rgba(60,44,24,.97); border-radius:9px; border:2.5px solid #fffbe8; padding:14px 20px; box-shadow:0 2px 12px #0005; color:#ffeec0; min-width:280px; max-width:320px; display:flex; flex-direction:column; flex:1 1 280px; }
.kro-btn { background:linear-gradient(90deg,#f7c873,#fcc65d); color:#32291f; font-family:'Cinzel',serif; padding:7px 18px; border-radius:9px; border:2px solid #fffbe8; font-weight:600; cursor:pointer; box-shadow:0 0 10px #f7c87366; }
.kro-btn:hover { background:linear-gradient(90deg,#fcc65d,#f7c873); box-shadow:0 0 18px #f7c87399; }
.kro-btn.kro-close { background:#b4874f; color:#fff; border:none; border-radius:50%; width:42px; height:42px; display:flex; justify-content:center; align-items:center; }

:root { --layout-col-width:760px; }
#progressbar,#story,#profile,#quests,#activequests { max-width:var(--layout-col-width); width:100%; margin:0 auto; }

/* Mentor overlay baggrund */
.kro-mentor-overlaybox--with-bg {
  position:relative; overflow:hidden; background:#111; color:#ffeec0; border-radius:18px;
}
.kro-mentor-overlaybox--with-bg::before {
  content:""; position:absolute; inset:0;
  background:
    linear-gradient(180deg,rgba(0,0,0,0.25),rgba(0,0,0,0.85)),
    var(--mentor-overlay-bg) center/cover no-repeat;
  filter:brightness(.9) saturate(1.1);
}
.kro-mentor-overlaybox--with-bg > * { position:relative; z-index:1; }

/* ---------- LORE POPUPS (opdateret) ---------- */
.lore-overlay-wrap {
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  padding:2.2rem clamp(1rem,3vw,2.2rem);
  background:radial-gradient(circle at 50% 50%,rgba(15,20,28,.68),rgba(8,10,14,.85));
  backdrop-filter:blur(6px) saturate(140%);
  -webkit-backdrop-filter:blur(6px) saturate(140%);
  pointer-events:auto; z-index:6000;
  animation:loreOverlayFade .35s ease;
}
@keyframes loreOverlayFade { from{opacity:0;} to{opacity:1;} }
.lore-overlay-fade { animation:loreOverlayFadeOut .3s forwards; }
@keyframes loreOverlayFadeOut { to{opacity:0;} }

/* Baseline popup (fallback når ingen archetype) */
.lore-popup {
  position:relative; width:100%; max-width:640px;
  background:linear-gradient(135deg,rgba(38,52,63,.88),rgba(28,36,44,.92) 55%,rgba(24,30,36,.96));
  border:1px solid #3b5666; border-radius:20px;
  padding:1.6rem 1.55rem 1.85rem;
  box-shadow:0 10px 34px -6px rgba(0,0,0,.6),
             0 0 0 1px rgba(255,255,255,.04),
             0 0 22px -2px rgba(110,170,230,.35);
  overflow:hidden; color:#e6f2fa;
  font-family:system-ui,"Segoe UI",Arial,sans-serif;
}

/* Archetype-baggrund aktiveret */
.lore-popup--arch {
  background:
    linear-gradient(160deg,rgba(12,16,20,0.35) 0%,rgba(12,16,20,0.78) 60%,rgba(8,10,14,0.92) 100%),
    var(--arch-bg) center/cover no-repeat;
}

/* Variant farvelægning (overlay blend via pseudo) */
.lore-popup--arch.lore-popup--major::before,
.lore-popup--arch.lore-popup--minor::before {
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  mix-blend-mode:overlay;
  opacity:.9;
}
.lore-popup--arch.lore-popup--major::before {
  background:
    radial-gradient(circle at 30% 20%,rgba(255,213,150,0.40),rgba(0,0,0,0) 55%),
    linear-gradient(145deg,rgba(255,196,120,0.18),rgba(0,0,0,0) 60%);
}
.lore-popup--arch.lore-popup--minor::before {
  background:
    radial-gradient(circle at 70% 25%,rgba(140,255,180,0.35),rgba(0,0,0,0) 55%),
    linear-gradient(145deg,rgba(120,210,150,0.18),rgba(0,0,0,0) 60%);
}

.lore-popup::after {
  content:""; position:absolute; inset:0; border-radius:inherit; padding:1px;
  background:linear-gradient(120deg,#5fa4d5,#b6d7ee 30%,#5fa4d5 60%,#8ecaf2);
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  opacity:.55; pointer-events:none;
}
.lore-popup--major::after {
  background:linear-gradient(120deg,#d5a55f,#f3d29a 30%,#d5a55f 60%,#f0c47a);
}
.lore-popup--minor::after {
  background:linear-gradient(120deg,#4fa86b,#8fd5a7 30%,#4fa86b 60%,#9be3b5);
}

.lore-popup-appear { animation:lorePopupIn .46s cubic-bezier(.3,.9,.25,1.2); }
.lore-popup-leave { animation:lorePopupOut .3s ease forwards; }
@keyframes lorePopupIn {
  0% { transform:scale(.82) translateY(14px); opacity:0; filter:brightness(.7) blur(2px); }
  60% { transform:scale(1.015) translateY(-2px); opacity:1; }
  100% { transform:scale(1) translateY(0); opacity:1; }
}
@keyframes lorePopupOut {
  to { transform:scale(.88) translateY(10px); opacity:0; filter:blur(2px); }
}

.lp-close {
  position:absolute; top:10px; right:10px;
  background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.2);
  color:#d4e9f6; width:34px; height:34px; border-radius:10px;
  font-size:15px; cursor:pointer; display:flex; align-items:center; justify-content:center;
  transition:background .25s, color .25s;
}
.lp-close:hover { background:rgba(255,255,255,.18); color:#fff; }
.lp-title {
  margin:0 0 1rem; font-size:1.45rem; font-weight:600; letter-spacing:.5px;
  display:flex; align-items:center; justify-content:center; gap:.65rem;
  color:#e3f2ff; text-shadow:0 0 8px rgba(120,180,240,.35);
}
.lore-popup--major .lp-title { color:#ffe9c8; text-shadow:0 0 10px rgba(255,210,130,.5); }
.lore-popup--minor .lp-title { color:#d5ffe4; text-shadow:0 0 10px rgba(130,230,170,.55); }

.lp-body { position:relative; z-index:2; min-height:90px; }
.lp-major { font-size:1.05rem; line-height:1.55rem; margin:0; }
.lp-minor-frag { font-size:1.05rem; line-height:1.45rem; margin:0; font-style:italic; }

.lp-actions { display:flex; justify-content:flex-end; gap:.8rem; margin-top:1.2rem; }
.lp-ok-btn {
  background:linear-gradient(90deg,#5fa4d5,#82c2f0); border:none; color:#0d2533;
  font-weight:600; padding:.65rem 1.15rem; border-radius:10px; cursor:pointer;
  box-shadow:0 4px 18px -2px rgba(100,160,210,.45); transition:background .25s, transform .25s;
}
.lp-ok-btn:hover { background:linear-gradient(90deg,#68b4ea,#95d4fb); transform:translateY(-2px); }

@media (max-width:540px){
  .lore-popup { max-width:92%; padding:1.2rem 1.1rem 1.4rem; border-radius:16px; }
  .lp-title { font-size:1.25rem; }
  .lp-major, .lp-minor-frag { font-size:1rem; line-height:1.45rem; }
}

/* ---------- KRØNIKE (uddrag) ---------- */
.book-page { padding:1rem; font-family:system-ui,Arial,sans-serif; }
.book-page h3 { margin-top:0; font-family:'Cinzel',serif; letter-spacing:.5px; }
.lore-list { display:flex; flex-direction:column; gap:.9rem; }
.lore-item { background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); padding:.75rem 1rem; border-radius:10px; backdrop-filter:blur(2px); }
.lore-head { display:flex; justify-content:space-between; font-size:.8rem; opacity:.8; }
.lore-title { font-weight:600; }
.lore-major { margin-top:.4rem; font-size:.95rem; line-height:1.3rem; }

/* Achievement toast (fra tidligere) */
.ach-toast { font-family:system-ui,Arial,sans-serif; }

/* Scroll lock fix i nogle browsere på mobil */
html.lock-scroll, body.lock-scroll { height:100%; overflow:hidden; }
